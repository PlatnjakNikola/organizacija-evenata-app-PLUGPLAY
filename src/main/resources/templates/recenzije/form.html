<!DOCTYPE html>
<html lang="hr" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: base('Recenzije','Moje recenzije','recenzije', ~{::content})}">
<th:block th:fragment="content">

    <!-- Forma -->
    <form th:action="@{/recenzije/save}" th:object="${recenzija}" method="post" class="mb-8 grid gap-4 bg-gray-800/40 p-6 rounded-xl">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input type="hidden" th:field="*{recenzijaID}"/>

        <div>
            <label class="block text-sm text-gray-300 mb-1">Događaj</label>
            <select name="dogadajId" class="w-full rounded-md bg-gray-800 text-white p-2"
                    th:value="${recenzija.dogadaj != null ? recenzija.dogadaj.dogadajID : null}">
                <option th:each="d : ${dogadaji}"
                        th:value="${d.dogadajID}"
                        th:selected="${recenzija.dogadaj != null and recenzija.dogadaj.dogadajID == d.dogadajID}"
                        th:text="${d.naziv}">Događaj</option>
            </select>
        </div>

        <div>
            <label class="block text-sm text-gray-300 mb-1">Ocjena</label>
            <select th:field="*{ocjena}" class="w-full rounded-md bg-gray-800 text-white p-2">
                <option th:each="o : ${ocjene}" th:value="${o}" th:text="${o}">5</option>
            </select>
        </div>

        <div>
            <label class="block text-sm text-gray-300 mb-1">Komentar</label>
            <textarea th:field="*{komentar}" rows="3"
                      class="w-full rounded-md bg-gray-800 text-white p-2"
                      placeholder="Napišite komentar..."></textarea>
        </div>

        <div class="flex gap-2">
            <button type="submit" class="rounded-md bg-indigo-600 px-4 py-2 text-white">Spremi</button>
            <a th:if="${recenzija.recenzijaID != null}" th:href="@{/recenzije}" class="rounded-md bg-gray-700 px-4 py-2 text-white">Odustani</a>
        </div>
    </form>

    <!-- Moje recenzije (samo moje!) -->
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-white/10">
            <thead>
            <tr class="text-left text-sm text-gray-300">
                <th class="py-3">#</th>
                <th class="py-3">Događaj</th>
                <th class="py-3">Ocjena</th>
                <th class="py-3">Komentar</th>
                <th class="py-3">Datum</th>
                <th class="py-3">Akcije</th>
            </tr>
            </thead>
            <tbody class="divide-y divide-white/10">
            <tr th:each="r, i : ${recenzije}" class="text-sm text-white">
                <td class="py-2" th:text="${i.index + 1}">1</td>
                <td class="py-2" th:text="${r.dogadaj != null ? r.dogadaj.naziv : '-'}">Naziv</td>
                <td class="py-2" th:text="${r.ocjena}">5</td>
                <td class="py-2 line-clamp-1"  onclick="this.classList.toggle('line-clamp-1')">
                    <span th:text="${r.komentar}">Komentar</span>
                </td>
                <td class="py-2" th:text="${#temporals.format(r.datumRecenzije, 'dd.MM.yyyy')}">-</td>
                <td class="py-2">
                    <a th:href="@{|/recenzije/edit/${r.recenzijaID}|}" class="text-indigo-400 hover:underline mr-3">Uredi</a>
                    <form th:action="@{|/recenzije/${r.recenzijaID}/delete|}" method="post" class="inline">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="text-red-400 hover:underline">Obriši</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</th:block>
</html>
